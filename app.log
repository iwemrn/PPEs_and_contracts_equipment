2025-04-04 12:26:17,329 - contracts - INFO - Загружены реквизиты для school_id 1: {'code_contract': '1', 'day': 4, 'month_name': 'апреля', 'year': 2025, 'year_next': 2026, 'num_contract': '0366200035624009751', 'date_contract': '07.02.2025', 'name_contract': 'на поставку ноутбуков для проведения ГИА в Тульской области в 2025 году', 'school_id': 1, 'school_fullname': 'Муниципальное Общеобразовательное учреждение "Арсеньевская Средняя Общеобразовательная Школа"', 'school_address': '301510, Тульская обл., Арсеньевский район, п. Арсеньево, ул. Халтурина, д. 11', 'INN': 7121002693, 'KPP': 712101001, 'OKPO': 52527018, 'OGRN': 1027103272701, 'cur_acc': '', 'bank_acc': '', 'pers_acc': '', 'fullname': 'Муниципальное Общеобразовательное учреждение "Арсеньевская Средняя Общеобразовательная Школа"', 'address': '301510, Тульская обл., Арсеньевский район, п. Арсеньево, ул. Халтурина, д. 11'}
2025-04-04 12:26:17,396 - contracts - INFO - Получено 1 позиций оборудования для организации для ППЭ 101
2025-04-04 12:26:17,396 - contracts - INFO - Список оборудования в контексте: 1 позиций
2025-04-04 12:26:17,438 - contracts - INFO - Получена информация об ответственном лице по ППЭ 101: {'job_title': 'директор', 'surname': 'Тестовый', 'name': 'Тест', 'second_name': 'Тестович'}
2025-04-04 12:26:17,438 - contracts - INFO - Добавлены переменные в родительном падеже: директора, Тестового Теста Тестовича
2025-04-04 12:26:17,438 - contracts - INFO - Ключи контекста: ['code_contract', 'day', 'month_name', 'year', 'year_next', 'num_contract', 'date_contract', 'name_contract', 'school_id', 'school_fullname', 'school_address', 'INN', 'KPP', 'OKPO', 'OGRN', 'cur_acc', 'bank_acc', 'pers_acc', 'fullname', 'address', 'ppe_address', 'equipment_list', 'total', 'total_price_text', 'job_title', 'surname', 'name', 'second_name', 'name_initial', 'second_name_initial', 'full_name_with_initials', 'responsible_fullname', 'job_title_genitive', 'surname_genitive', 'name_genitive', 'second_name_genitive', 'full_name_genitive', 'full_name_with_initials_genitive', 'job_title_and_full_name_genitive', 'job_title_and_full_name_with_initials_genitive']
2025-04-04 12:26:17,438 - contracts - INFO - Переменные для ответственного лица:
2025-04-04 12:26:17,438 - contracts - INFO -   job_title: директор
2025-04-04 12:26:17,439 - contracts - INFO -   surname: Тестовый
2025-04-04 12:26:17,439 - contracts - INFO -   name: Тест
2025-04-04 12:26:17,439 - contracts - INFO -   second_name: Тестович
2025-04-04 12:26:17,439 - contracts - INFO -   job_title_genitive: директора
2025-04-04 12:26:17,439 - contracts - INFO -   surname_genitive: Тестового
2025-04-04 12:26:17,439 - contracts - INFO -   name_genitive: Теста
2025-04-04 12:26:17,439 - contracts - INFO -   second_name_genitive: Тестовича
2025-04-04 12:26:17,440 - contracts - INFO -   full_name_with_initials: Тестовый Т. Т.
2025-04-04 12:26:17,440 - contracts - INFO -   full_name_with_initials_genitive: Тестового Т. Т.
2025-04-04 12:26:17,440 - contracts - INFO -   job_title_and_full_name_genitive: директора Тестового Теста Тестовича
2025-04-04 12:26:17,440 - contracts - INFO -   job_title_and_full_name_with_initials_genitive: директора Тестового Т. Т.
2025-04-04 12:26:20,249 - contracts - INFO - Договор сформирован и сохранён: C:\Users\erokhina\Documents\TempContracts\preview_contract_101_20250404122617.docx
2025-04-04 12:28:06,262 - contracts - INFO - Загружены реквизиты для school_id 1: {'code_contract': '1', 'day': 4, 'month_name': 'апреля', 'year': 2025, 'year_next': 2026, 'num_contract': '0366200035624009751', 'date_contract': '07.02.2025', 'name_contract': 'на поставку ноутбуков для проведения ГИА в Тульской области в 2025 году', 'school_id': 1, 'school_fullname': 'Муниципальное Общеобразовательное учреждение "Арсеньевская Средняя Общеобразовательная Школа"', 'school_address': '301510, Тульская обл., Арсеньевский район, п. Арсеньево, ул. Халтурина, д. 11', 'INN': 7121002693, 'KPP': 712101001, 'OKPO': 52527018, 'OGRN': 1027103272701, 'cur_acc': '', 'bank_acc': '', 'pers_acc': '', 'fullname': 'Муниципальное Общеобразовательное учреждение "Арсеньевская Средняя Общеобразовательная Школа"', 'address': '301510, Тульская обл., Арсеньевский район, п. Арсеньево, ул. Халтурина, д. 11'}
2025-04-04 12:28:06,324 - contracts - INFO - Получено 1 позиций оборудования для организации для ППЭ 101
2025-04-04 12:28:06,325 - contracts - INFO - Список оборудования в контексте: 1 позиций
2025-04-04 12:28:06,352 - contracts - INFO - Получена информация об ответственном лице по ППЭ 101: {'job_title': 'директор', 'surname': 'Тестовый', 'name': 'Тест', 'second_name': 'Тестович'}
2025-04-04 12:28:06,353 - contracts - INFO - Добавлены переменные в родительном падеже: директора, Тестового Теста Тестовича
2025-04-04 12:28:06,353 - contracts - INFO - Ключи контекста: ['code_contract', 'day', 'month_name', 'year', 'year_next', 'num_contract', 'date_contract', 'name_contract', 'school_id', 'school_fullname', 'school_address', 'INN', 'KPP', 'OKPO', 'OGRN', 'cur_acc', 'bank_acc', 'pers_acc', 'fullname', 'address', 'ppe_address', 'equipment_list', 'total', 'total_price_text', 'job_title', 'surname', 'name', 'second_name', 'name_initial', 'second_name_initial', 'full_name_with_initials', 'responsible_fullname', 'job_title_genitive', 'surname_genitive', 'name_genitive', 'second_name_genitive', 'full_name_genitive', 'full_name_with_initials_genitive', 'job_title_and_full_name_genitive', 'job_title_and_full_name_with_initials_genitive']
2025-04-04 12:28:06,353 - contracts - INFO - Переменные для ответственного лица:
2025-04-04 12:28:06,354 - contracts - INFO -   job_title: директор
2025-04-04 12:28:06,354 - contracts - INFO -   surname: Тестовый
2025-04-04 12:28:06,354 - contracts - INFO -   name: Тест
2025-04-04 12:28:06,354 - contracts - INFO -   second_name: Тестович
2025-04-04 12:28:06,354 - contracts - INFO -   job_title_genitive: директора
2025-04-04 12:28:06,355 - contracts - INFO -   surname_genitive: Тестового
2025-04-04 12:28:06,355 - contracts - INFO -   name_genitive: Теста
2025-04-04 12:28:06,355 - contracts - INFO -   second_name_genitive: Тестовича
2025-04-04 12:28:06,355 - contracts - INFO -   full_name_with_initials: Тестовый Т. Т.
2025-04-04 12:28:06,355 - contracts - INFO -   full_name_with_initials_genitive: Тестового Т. Т.
2025-04-04 12:28:06,356 - contracts - INFO -   job_title_and_full_name_genitive: директора Тестового Теста Тестовича
2025-04-04 12:28:06,356 - contracts - INFO -   job_title_and_full_name_with_initials_genitive: директора Тестового Т. Т.
2025-04-04 12:28:06,357 - contracts - ERROR - Ошибка при генерации договора: [Errno 2] No such file or directory: 'C:\\Users\\erokhina\\Desktop\\coding\\PPEs_and_contracts_equipment\\templates\\[Content_Types].xml'
2025-04-04 12:28:06,372 - contracts - ERROR - Traceback (most recent call last):
  File "C:\Users\erokhina\Desktop\coding\PPEs_and_contracts_equipment\contracts.py", line 528, in generate_contract
    doc.render(context)
  File "C:\Users\erokhina\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\docxtpl\template.py", line 475, in render
    self.render_init()
  File "C:\Users\erokhina\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\docxtpl\template.py", line 56, in render_init
    self.init_docx()
  File "C:\Users\erokhina\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\docxtpl\template.py", line 52, in init_docx
    self.docx = Document(self.template_file)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\erokhina\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\docx\api.py", line 27, in Document
    document_part = cast("DocumentPart", Package.open(docx).main_document_part)
                                         ^^^^^^^^^^^^^^^^^^
  File "C:\Users\erokhina\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\docx\opc\package.py", line 127, in open
    pkg_reader = PackageReader.from_file(pkg_file)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\erokhina\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\docx\opc\pkgreader.py", line 23, in from_file
    content_types = _ContentTypeMap.from_xml(phys_reader.content_types_xml)
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\erokhina\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\docx\opc\phys_pkg.py", line 59, in content_types_xml
    return self.blob_for(CONTENT_TYPES_URI)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\erokhina\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\docx\opc\phys_pkg.py", line 47, in blob_for
    with open(path, "rb") as f:
         ^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'C:\\Users\\erokhina\\Desktop\\coding\\PPEs_and_contracts_equipment\\templates\\[Content_Types].xml'

2025-04-04 12:28:56,650 - contracts - INFO - Загружены реквизиты для school_id 1: {'code_contract': '1', 'day': 4, 'month_name': 'апреля', 'year': 2025, 'year_next': 2026, 'num_contract': '0366200035624009751', 'date_contract': '07.02.2025', 'name_contract': 'на поставку ноутбуков для проведения ГИА в Тульской области в 2025 году', 'school_id': 1, 'school_fullname': 'Муниципальное Общеобразовательное учреждение "Арсеньевская Средняя Общеобразовательная Школа"', 'school_address': '301510, Тульская обл., Арсеньевский район, п. Арсеньево, ул. Халтурина, д. 11', 'INN': 7121002693, 'KPP': 712101001, 'OKPO': 52527018, 'OGRN': 1027103272701, 'cur_acc': '', 'bank_acc': '', 'pers_acc': '', 'fullname': 'Муниципальное Общеобразовательное учреждение "Арсеньевская Средняя Общеобразовательная Школа"', 'address': '301510, Тульская обл., Арсеньевский район, п. Арсеньево, ул. Халтурина, д. 11'}
2025-04-04 12:28:56,748 - contracts - INFO - Получено 1 позиций оборудования для организации для ППЭ 101
2025-04-04 12:28:56,749 - contracts - INFO - Список оборудования в контексте: 1 позиций
2025-04-04 12:28:56,787 - contracts - INFO - Получена информация об ответственном лице по ППЭ 101: {'job_title': 'директор', 'surname': 'Тестовый', 'name': 'Тест', 'second_name': 'Тестович'}
2025-04-04 12:28:56,787 - contracts - INFO - Добавлены переменные в родительном падеже: директора, Тестового Теста Тестовича
2025-04-04 12:28:56,788 - contracts - INFO - Ключи контекста: ['code_contract', 'day', 'month_name', 'year', 'year_next', 'num_contract', 'date_contract', 'name_contract', 'school_id', 'school_fullname', 'school_address', 'INN', 'KPP', 'OKPO', 'OGRN', 'cur_acc', 'bank_acc', 'pers_acc', 'fullname', 'address', 'ppe_address', 'equipment_list', 'total', 'total_price_text', 'job_title', 'surname', 'name', 'second_name', 'name_initial', 'second_name_initial', 'full_name_with_initials', 'responsible_fullname', 'job_title_genitive', 'surname_genitive', 'name_genitive', 'second_name_genitive', 'full_name_genitive', 'full_name_with_initials_genitive', 'job_title_and_full_name_genitive', 'job_title_and_full_name_with_initials_genitive']
2025-04-04 12:28:56,788 - contracts - INFO - Переменные для ответственного лица:
2025-04-04 12:28:56,788 - contracts - INFO -   job_title: директор
2025-04-04 12:28:56,788 - contracts - INFO -   surname: Тестовый
2025-04-04 12:28:56,788 - contracts - INFO -   name: Тест
2025-04-04 12:28:56,789 - contracts - INFO -   second_name: Тестович
2025-04-04 12:28:56,789 - contracts - INFO -   job_title_genitive: директора
2025-04-04 12:28:56,789 - contracts - INFO -   surname_genitive: Тестового
2025-04-04 12:28:56,789 - contracts - INFO -   name_genitive: Теста
2025-04-04 12:28:56,789 - contracts - INFO -   second_name_genitive: Тестовича
2025-04-04 12:28:56,789 - contracts - INFO -   full_name_with_initials: Тестовый Т. Т.
2025-04-04 12:28:56,789 - contracts - INFO -   full_name_with_initials_genitive: Тестового Т. Т.
2025-04-04 12:28:56,790 - contracts - INFO -   job_title_and_full_name_genitive: директора Тестового Теста Тестовича
2025-04-04 12:28:56,790 - contracts - INFO -   job_title_and_full_name_with_initials_genitive: директора Тестового Т. Т.
2025-04-04 12:28:57,506 - contracts - INFO - Договор сформирован и сохранён: C:\Users\erokhina\Documents\TempContracts\preview_contract_101_20250404122856.docx
2025-04-07 10:48:54,482 - database - ERROR - Ошибка выполнения запроса: column "ppe_number" does not exist
LINE 4:         WHERE ppe_number = '1'
                      ^

2025-04-07 10:48:55,161 - database - ERROR - Ошибка выполнения запроса: column "ppe_number" does not exist
LINE 4:         WHERE ppe_number = '1'
                      ^

2025-04-07 12:14:12,772 - contracts - INFO - Загружены реквизиты для school_id 1: {'code_contract': '1', 'day': 7, 'month_name': 'апреля', 'year': 2025, 'year_next': 2026, 'num_contract': '0366200035624007702', 'date_contract': '02.12.2024', 'name_contract': 'на поставку ноутбуков для проведения ГИА в Тульской области', 'school_id': 1, 'school_fullname': 'Муниципальное Общеобразовательное учреждение "Арсеньевская Средняя Общеобразовательная Школа"', 'school_address': '301510, Тульская обл., Арсеньевский район, п. Арсеньево, ул. Халтурина, д. 11', 'INN': 7121002693, 'KPP': 712101001, 'OKPO': 52527018, 'OGRN': 1027103272701, 'cur_acc': '40102810445370000059', 'bank_acc': '03231643706040006600', 'pers_acc': 857020041, 'fullname': 'Муниципальное Общеобразовательное учреждение "Арсеньевская Средняя Общеобразовательная Школа"', 'address': '301510, Тульская обл., Арсеньевский район, п. Арсеньево, ул. Халтурина, д. 11'}
2025-04-07 12:14:12,797 - contracts - INFO - Получено 3 позиций оборудования для организации с school_id 1
2025-04-07 12:14:12,801 - contracts - INFO - Список оборудования в контексте: 3 позиций
2025-04-07 12:14:12,846 - database - ERROR - Ошибка выполнения запроса: column r.ppe_number does not exist
LINE 4:         JOIN dat_ppe p ON r.ppe_number = p.id
                                  ^
HINT:  Perhaps you meant to reference the column "p.ppe_number".

2025-04-07 12:14:12,847 - contracts - ERROR - Ошибка при получении информации об ответственном: column r.ppe_number does not exist
LINE 4:         JOIN dat_ppe p ON r.ppe_number = p.id
                                  ^
HINT:  Perhaps you meant to reference the column "p.ppe_number".

2025-04-07 12:14:12,853 - contracts - ERROR - Traceback (most recent call last):
  File "C:\Users\erokhina\Desktop\coding\PPEs_and_contracts_equipment\contracts.py", line 426, in generate_contract
    responsible_info = get_responsible_info_by_school_id(identifier)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\erokhina\Desktop\coding\PPEs_and_contracts_equipment\contracts.py", line 218, in get_responsible_info_by_school_id
    rows = execute_query(query, (school_id,))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\erokhina\Desktop\coding\PPEs_and_contracts_equipment\database.py", line 53, in execute_query
    cursor.execute(query, params or ())
psycopg2.errors.UndefinedColumn: column r.ppe_number does not exist
LINE 4:         JOIN dat_ppe p ON r.ppe_number = p.id
                                  ^
HINT:  Perhaps you meant to reference the column "p.ppe_number".


2025-04-07 12:14:12,853 - contracts - INFO - Ключи контекста: ['code_contract', 'day', 'month_name', 'year', 'year_next', 'num_contract', 'date_contract', 'name_contract', 'school_id', 'school_fullname', 'school_address', 'INN', 'KPP', 'OKPO', 'OGRN', 'cur_acc', 'bank_acc', 'pers_acc', 'fullname', 'address', 'equipment_list', 'total', 'total_price_text', 'job_title', 'surname', 'name', 'second_name', 'name_initial', 'second_name_initial', 'full_name_with_initials', 'responsible_fullname', 'job_title_genitive', 'surname_genitive', 'name_genitive', 'second_name_genitive', 'full_name_genitive', 'full_name_with_initials_genitive', 'job_title_and_full_name_genitive', 'job_title_and_full_name_with_initials_genitive']
2025-04-07 12:14:12,854 - contracts - INFO - Переменные для ответственного лица:
2025-04-07 12:14:12,854 - contracts - INFO -   job_title: 
2025-04-07 12:14:12,854 - contracts - INFO -   surname: 
2025-04-07 12:14:12,854 - contracts - INFO -   name: 
2025-04-07 12:14:12,854 - contracts - INFO -   second_name: 
2025-04-07 12:14:12,854 - contracts - INFO -   job_title_genitive: 
2025-04-07 12:14:12,855 - contracts - INFO -   surname_genitive: 
2025-04-07 12:14:12,855 - contracts - INFO -   name_genitive: 
2025-04-07 12:14:12,855 - contracts - INFO -   second_name_genitive: 
2025-04-07 12:14:12,855 - contracts - INFO -   full_name_with_initials: 
2025-04-07 12:14:12,855 - contracts - INFO -   full_name_with_initials_genitive: 
2025-04-07 12:14:12,855 - contracts - INFO -   job_title_and_full_name_genitive: 
2025-04-07 12:14:12,855 - contracts - INFO -   job_title_and_full_name_with_initials_genitive: 
2025-04-07 12:14:13,735 - contracts - INFO - Договор сформирован и сохранён: C:\Users\erokhina\Documents\TempContracts\preview_contract_1_20250407121412.docx
2025-04-21 14:22:24,151 - contracts - INFO - Загружены реквизиты для school_id 1: {'code_contract': '1', 'day': 21, 'month_name': 'апреля', 'year': 2025, 'year_next': 2026, 'num_contract': '0366200035624007702', 'date_contract': '02.12.2024', 'name_contract': 'на поставку ноутбуков для проведения ГИА в Тульской области', 'school_id': 1, 'school_fullname': 'муниципальное общеобразовательное учреждение «Арсеньевская средняя общеобразовательная школа»', 'school_address': '301510, Тульская обл., Арсеньевский район, п. Арсеньево, ул. Халтурина, д. 11', 'INN': 7121002693, 'KPP': 712101001, 'OKPO': 52527018, 'OGRN': 1027103272701, 'cur_acc': '40102810445370000059', 'bank_acc': '03231643706040006600', 'pers_acc': '857020041', 'fullname': 'муниципальное общеобразовательное учреждение «Арсеньевская средняя общеобразовательная школа»', 'address': '301510, Тульская обл., Арсеньевский район, п. Арсеньево, ул. Халтурина, д. 11'}
2025-04-21 14:22:24,241 - contracts - INFO - Получено 1 позиций оборудования для организации для ППЭ 1
2025-04-21 14:22:24,243 - contracts - INFO - Список оборудования в контексте: 1 позиций
2025-04-21 14:22:24,291 - database - ERROR - Ошибка выполнения запроса: column "ppe_number" does not exist
LINE 4:         WHERE ppe_number = '1'
                      ^

2025-04-21 14:22:24,291 - contracts - ERROR - Ошибка при получении информации об ответственном: column "ppe_number" does not exist
LINE 4:         WHERE ppe_number = '1'
                      ^

2025-04-21 14:22:24,291 - contracts - ERROR - Traceback (most recent call last):
  File "C:\Users\erokhina\Desktop\coding\PPEs_and_contracts_equipment\contracts.py", line 429, in generate_contract
    responsible_info = get_responsible_info(identifier)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\erokhina\Desktop\coding\PPEs_and_contracts_equipment\contracts.py", line 188, in get_responsible_info
    rows = execute_query(query, (ppe_number,))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\erokhina\Desktop\coding\PPEs_and_contracts_equipment\database.py", line 53, in execute_query
    cursor.execute(query, params or ())
psycopg2.errors.UndefinedColumn: column "ppe_number" does not exist
LINE 4:         WHERE ppe_number = '1'
                      ^


2025-04-21 14:22:24,291 - contracts - INFO - Ключи контекста: ['code_contract', 'day', 'month_name', 'year', 'year_next', 'num_contract', 'date_contract', 'name_contract', 'school_id', 'school_fullname', 'school_address', 'INN', 'KPP', 'OKPO', 'OGRN', 'cur_acc', 'bank_acc', 'pers_acc', 'fullname', 'address', 'ppe_address', 'equipment_list', 'total', 'total_price_text', 'job_title', 'surname', 'name', 'second_name', 'name_initial', 'second_name_initial', 'full_name_with_initials', 'responsible_fullname', 'job_title_genitive', 'surname_genitive', 'name_genitive', 'second_name_genitive', 'full_name_genitive', 'full_name_with_initials_genitive', 'job_title_and_full_name_genitive', 'job_title_and_full_name_with_initials_genitive']
2025-04-21 14:22:24,291 - contracts - INFO - Переменные для ответственного лица:
2025-04-21 14:22:24,291 - contracts - INFO -   job_title: 
2025-04-21 14:22:24,291 - contracts - INFO -   surname: 
2025-04-21 14:22:24,291 - contracts - INFO -   name: 
2025-04-21 14:22:24,291 - contracts - INFO -   second_name: 
2025-04-21 14:22:24,291 - contracts - INFO -   job_title_genitive: 
2025-04-21 14:22:24,291 - contracts - INFO -   surname_genitive: 
2025-04-21 14:22:24,291 - contracts - INFO -   name_genitive: 
2025-04-21 14:22:24,291 - contracts - INFO -   second_name_genitive: 
2025-04-21 14:22:24,291 - contracts - INFO -   full_name_with_initials: 
2025-04-21 14:22:24,291 - contracts - INFO -   full_name_with_initials_genitive: 
2025-04-21 14:22:24,291 - contracts - INFO -   job_title_and_full_name_genitive: 
2025-04-21 14:22:24,291 - contracts - INFO -   job_title_and_full_name_with_initials_genitive: 
2025-04-21 14:22:25,111 - contracts - INFO - Договор сформирован и сохранён: C:\Users\erokhina\Documents\TempContracts\preview_contract_1_20250421142223.docx
2025-04-21 14:23:02,881 - contracts - INFO - Загружены реквизиты для school_id 74: {'code_contract': '1', 'day': 21, 'month_name': 'апреля', 'year': 2025, 'year_next': 2026, 'num_contract': '0366200035624009751', 'date_contract': '07.02.2025', 'name_contract': 'на поставку ноутбуков для проведения ГИА в Тульской области в 2025 году', 'school_id': 74, 'school_fullname': 'муниципальное бюджетное общеобразовательное учреждение «Центр образования № 12»', 'school_address': '300062, Тульская обл., г. Тула, ул. Литейная, д. 25', 'INN': 7103045920, 'KPP': 710301001, 'OKPO': 24668151, 'OGRN': 1157154029823, 'cur_acc': '40102810445370000059', 'bank_acc': 'ХХХХХХХХХХХХ', 'pers_acc': 'ХХХХХХХХХ', 'fullname': 'муниципальное бюджетное общеобразовательное учреждение «Центр образования № 12»', 'address': '300062, Тульская обл., г. Тула, ул. Литейная, д. 25'}
2025-04-21 14:23:02,961 - contracts - INFO - Получено 2 позиций оборудования для организации для ППЭ 213
2025-04-21 14:23:02,961 - contracts - INFO - Список оборудования в контексте: 2 позиций
2025-04-21 14:23:02,993 - database - ERROR - Ошибка выполнения запроса: column "ppe_number" does not exist
LINE 4:         WHERE ppe_number = '213'
                      ^

2025-04-21 14:23:02,993 - contracts - ERROR - Ошибка при получении информации об ответственном: column "ppe_number" does not exist
LINE 4:         WHERE ppe_number = '213'
                      ^

2025-04-21 14:23:02,993 - contracts - ERROR - Traceback (most recent call last):
  File "C:\Users\erokhina\Desktop\coding\PPEs_and_contracts_equipment\contracts.py", line 429, in generate_contract
    responsible_info = get_responsible_info(identifier)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\erokhina\Desktop\coding\PPEs_and_contracts_equipment\contracts.py", line 188, in get_responsible_info
    rows = execute_query(query, (ppe_number,))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\erokhina\Desktop\coding\PPEs_and_contracts_equipment\database.py", line 53, in execute_query
    cursor.execute(query, params or ())
psycopg2.errors.UndefinedColumn: column "ppe_number" does not exist
LINE 4:         WHERE ppe_number = '213'
                      ^


2025-04-21 14:23:02,993 - contracts - INFO - Ключи контекста: ['code_contract', 'day', 'month_name', 'year', 'year_next', 'num_contract', 'date_contract', 'name_contract', 'school_id', 'school_fullname', 'school_address', 'INN', 'KPP', 'OKPO', 'OGRN', 'cur_acc', 'bank_acc', 'pers_acc', 'fullname', 'address', 'ppe_address', 'equipment_list', 'total', 'total_price_text', 'job_title', 'surname', 'name', 'second_name', 'name_initial', 'second_name_initial', 'full_name_with_initials', 'responsible_fullname', 'job_title_genitive', 'surname_genitive', 'name_genitive', 'second_name_genitive', 'full_name_genitive', 'full_name_with_initials_genitive', 'job_title_and_full_name_genitive', 'job_title_and_full_name_with_initials_genitive']
2025-04-21 14:23:02,993 - contracts - INFO - Переменные для ответственного лица:
2025-04-21 14:23:02,993 - contracts - INFO -   job_title: 
2025-04-21 14:23:02,993 - contracts - INFO -   surname: 
2025-04-21 14:23:02,993 - contracts - INFO -   name: 
2025-04-21 14:23:02,993 - contracts - INFO -   second_name: 
2025-04-21 14:23:03,001 - contracts - INFO -   job_title_genitive: 
2025-04-21 14:23:03,001 - contracts - INFO -   surname_genitive: 
2025-04-21 14:23:03,001 - contracts - INFO -   name_genitive: 
2025-04-21 14:23:03,001 - contracts - INFO -   second_name_genitive: 
2025-04-21 14:23:03,001 - contracts - INFO -   full_name_with_initials: 
2025-04-21 14:23:03,001 - contracts - INFO -   full_name_with_initials_genitive: 
2025-04-21 14:23:03,001 - contracts - INFO -   job_title_and_full_name_genitive: 
2025-04-21 14:23:03,001 - contracts - INFO -   job_title_and_full_name_with_initials_genitive: 
2025-04-21 14:23:03,670 - contracts - INFO - Договор сформирован и сохранён: C:\Users\erokhina\Documents\TempContracts\preview_contract_213_20250421142302.docx
2025-04-21 14:29:06,860 - contracts - INFO - Загружены реквизиты для school_id 74: {'code_contract': '1', 'day': 21, 'month_name': 'апреля', 'year': 2025, 'year_next': 2026, 'num_contract': '0366200035624009751', 'date_contract': '07.02.2025', 'name_contract': 'на поставку ноутбуков для проведения ГИА в Тульской области в 2025 году', 'school_id': 74, 'school_fullname': 'муниципальное бюджетное общеобразовательное учреждение «Центр образования № 12»', 'school_address': '300062, Тульская обл., г. Тула, ул. Литейная, д. 25', 'INN': 7103045920, 'KPP': 710301001, 'OKPO': 24668151, 'OGRN': 1157154029823, 'cur_acc': '40102810445370000059', 'bank_acc': 'ХХХХХХХХХХХХ', 'pers_acc': 'ХХХХХХХХХ', 'fullname': 'муниципальное бюджетное общеобразовательное учреждение «Центр образования № 12»', 'address': '300062, Тульская обл., г. Тула, ул. Литейная, д. 25'}
2025-04-21 14:29:06,908 - contracts - INFO - Получено 2 позиций оборудования для организации с school_id 74
2025-04-21 14:29:06,908 - contracts - INFO - Список оборудования в контексте: 2 позиций
2025-04-21 14:29:06,959 - database - ERROR - Ошибка выполнения запроса: column r.ppe_number does not exist
LINE 4:         JOIN dat_ppe p ON r.ppe_number = p.id
                                  ^
HINT:  Perhaps you meant to reference the column "p.ppe_number".

2025-04-21 14:29:06,961 - contracts - ERROR - Ошибка при получении информации об ответственном: column r.ppe_number does not exist
LINE 4:         JOIN dat_ppe p ON r.ppe_number = p.id
                                  ^
HINT:  Perhaps you meant to reference the column "p.ppe_number".

2025-04-21 14:29:06,961 - contracts - ERROR - Traceback (most recent call last):
  File "C:\Users\erokhina\Desktop\coding\PPEs_and_contracts_equipment\contracts.py", line 426, in generate_contract
    responsible_info = get_responsible_info_by_school_id(identifier)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\erokhina\Desktop\coding\PPEs_and_contracts_equipment\contracts.py", line 218, in get_responsible_info_by_school_id
    rows = execute_query(query, (school_id,))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\erokhina\Desktop\coding\PPEs_and_contracts_equipment\database.py", line 53, in execute_query
    cursor.execute(query, params or ())
psycopg2.errors.UndefinedColumn: column r.ppe_number does not exist
LINE 4:         JOIN dat_ppe p ON r.ppe_number = p.id
                                  ^
HINT:  Perhaps you meant to reference the column "p.ppe_number".


2025-04-21 14:29:06,961 - contracts - INFO - Ключи контекста: ['code_contract', 'day', 'month_name', 'year', 'year_next', 'num_contract', 'date_contract', 'name_contract', 'school_id', 'school_fullname', 'school_address', 'INN', 'KPP', 'OKPO', 'OGRN', 'cur_acc', 'bank_acc', 'pers_acc', 'fullname', 'address', 'equipment_list', 'total', 'total_price_text', 'job_title', 'surname', 'name', 'second_name', 'name_initial', 'second_name_initial', 'full_name_with_initials', 'responsible_fullname', 'job_title_genitive', 'surname_genitive', 'name_genitive', 'second_name_genitive', 'full_name_genitive', 'full_name_with_initials_genitive', 'job_title_and_full_name_genitive', 'job_title_and_full_name_with_initials_genitive']
2025-04-21 14:29:06,961 - contracts - INFO - Переменные для ответственного лица:
2025-04-21 14:29:06,961 - contracts - INFO -   job_title: 
2025-04-21 14:29:06,961 - contracts - INFO -   surname: 
2025-04-21 14:29:06,961 - contracts - INFO -   name: 
2025-04-21 14:29:06,961 - contracts - INFO -   second_name: 
2025-04-21 14:29:06,961 - contracts - INFO -   job_title_genitive: 
2025-04-21 14:29:06,961 - contracts - INFO -   surname_genitive: 
2025-04-21 14:29:06,961 - contracts - INFO -   name_genitive: 
2025-04-21 14:29:06,961 - contracts - INFO -   second_name_genitive: 
2025-04-21 14:29:06,961 - contracts - INFO -   full_name_with_initials: 
2025-04-21 14:29:06,961 - contracts - INFO -   full_name_with_initials_genitive: 
2025-04-21 14:29:06,961 - contracts - INFO -   job_title_and_full_name_genitive: 
2025-04-21 14:29:06,968 - contracts - INFO -   job_title_and_full_name_with_initials_genitive: 
2025-04-21 14:29:07,687 - contracts - INFO - Договор сформирован и сохранён: C:\Users\erokhina\Documents\TempContracts\preview_contract_213_20250421142906.docx
2025-04-21 14:42:39,162 - contracts - INFO - Загружены реквизиты для school_id 74: {'code_contract': '1', 'day': 21, 'month_name': 'апреля', 'year': 2025, 'year_next': 2026, 'num_contract': '0366200035624009751', 'date_contract': '07.02.2025', 'name_contract': 'на поставку ноутбуков для проведения ГИА в Тульской области в 2025 году', 'school_id': 74, 'school_fullname': 'муниципальное бюджетное общеобразовательное учреждение «Центр образования № 12»', 'school_address': '300062, Тульская обл., г. Тула, ул. Литейная, д. 25', 'INN': 7103045920, 'KPP': 710301001, 'OKPO': 24668151, 'OGRN': 1157154029823, 'cur_acc': '40102810445370000059', 'bank_acc': 'ХХХХХХХХХХХХ', 'pers_acc': 'ХХХХХХХХХ', 'fullname': 'муниципальное бюджетное общеобразовательное учреждение «Центр образования № 12»', 'address': '300062, Тульская обл., г. Тула, ул. Литейная, д. 25'}
2025-04-21 14:42:39,210 - contracts - INFO - Получено 2 позиций оборудования для организации с school_id 74
2025-04-21 14:42:39,210 - contracts - INFO - Список оборудования в контексте: 2 позиций
2025-04-21 14:42:39,259 - database - ERROR - Ошибка выполнения запроса: column r.ppe_number does not exist
LINE 4:         JOIN dat_ppe p ON r.ppe_number = p.id
                                  ^
HINT:  Perhaps you meant to reference the column "p.ppe_number".

2025-04-21 14:42:39,260 - contracts - ERROR - Ошибка при получении информации об ответственном: column r.ppe_number does not exist
LINE 4:         JOIN dat_ppe p ON r.ppe_number = p.id
                                  ^
HINT:  Perhaps you meant to reference the column "p.ppe_number".

2025-04-21 14:42:39,262 - contracts - ERROR - Traceback (most recent call last):
  File "C:\Users\erokhina\Desktop\coding\PPEs_and_contracts_equipment\contracts.py", line 427, in generate_contract
    responsible_info = get_responsible_info_by_school_id(identifier)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\erokhina\Desktop\coding\PPEs_and_contracts_equipment\contracts.py", line 218, in get_responsible_info_by_school_id
    rows = execute_query(query, (school_id,))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\erokhina\Desktop\coding\PPEs_and_contracts_equipment\database.py", line 53, in execute_query
    cursor.execute(query, params or ())
psycopg2.errors.UndefinedColumn: column r.ppe_number does not exist
LINE 4:         JOIN dat_ppe p ON r.ppe_number = p.id
                                  ^
HINT:  Perhaps you meant to reference the column "p.ppe_number".


2025-04-21 14:42:39,262 - contracts - INFO - Ключи контекста: ['code_contract', 'day', 'month_name', 'year', 'year_next', 'num_contract', 'date_contract', 'name_contract', 'school_id', 'school_fullname', 'school_address', 'INN', 'KPP', 'OKPO', 'OGRN', 'cur_acc', 'bank_acc', 'pers_acc', 'fullname', 'address', 'equipment_list', 'total', 'total_price_text', 'job_title', 'surname', 'name', 'second_name', 'name_initial', 'second_name_initial', 'full_name_with_initials', 'responsible_fullname', 'job_title_genitive', 'surname_genitive', 'name_genitive', 'second_name_genitive', 'full_name_genitive', 'full_name_with_initials_genitive', 'job_title_and_full_name_genitive', 'job_title_and_full_name_with_initials_genitive']
2025-04-21 14:42:39,262 - contracts - INFO - Переменные для ответственного лица:
2025-04-21 14:42:39,262 - contracts - INFO -   job_title: 
2025-04-21 14:42:39,262 - contracts - INFO -   surname: 
2025-04-21 14:42:39,262 - contracts - INFO -   name: 
2025-04-21 14:42:39,262 - contracts - INFO -   second_name: 
2025-04-21 14:42:39,262 - contracts - INFO -   job_title_genitive: 
2025-04-21 14:42:39,262 - contracts - INFO -   surname_genitive: 
2025-04-21 14:42:39,262 - contracts - INFO -   name_genitive: 
2025-04-21 14:42:39,262 - contracts - INFO -   second_name_genitive: 
2025-04-21 14:42:39,262 - contracts - INFO -   full_name_with_initials: 
2025-04-21 14:42:39,262 - contracts - INFO -   full_name_with_initials_genitive: 
2025-04-21 14:42:39,262 - contracts - INFO -   job_title_and_full_name_genitive: 
2025-04-21 14:42:39,262 - contracts - INFO -   job_title_and_full_name_with_initials_genitive: 
2025-04-21 14:42:40,059 - contracts - INFO - Договор сформирован и сохранён: C:\Users\erokhina\Documents\TempContracts\preview_contract_213_20250421144238.docx
2025-04-21 15:16:53,864 - contracts - INFO - Загружены реквизиты для school_id 110: {'code_contract': '1', 'day': 21, 'month_name': 'апреля', 'year': 2025, 'year_next': 2026, 'num_contract': '0366200035624007702', 'date_contract': '02.12.2024', 'name_contract': 'на поставку ноутбуков для проведения ГИА в Тульской области', 'school_id': 110, 'school_fullname': 'Муниципальное бюджетное общеобразовательное учреждение "Средняя общеобразовательная школа № 5 (центр образования) г. Суворова имени Героя Советского Союза Е.П.Тарасова"', 'school_address': '301430, Тульская обл., Суворовский район, г. Суворов, ул. Пионерская, д. 11', 'INN': 7133009870, 'KPP': 713301001, 'OKPO': 4352719, 'OGRN': 1027103471130, 'cur_acc': '40102810445370000059', 'bank_acc': 'ХХХХХХХХХХХХ', 'pers_acc': 'ХХХХХХХХХ', 'fullname': 'Муниципальное бюджетное общеобразовательное учреждение "Средняя общеобразовательная школа № 5 (центр образования) г. Суворова имени Героя Советского Союза Е.П.Тарасова"', 'address': '301430, Тульская обл., Суворовский район, г. Суворов, ул. Пионерская, д. 11'}
2025-04-21 15:16:53,895 - contracts - INFO - Получено 1 позиций оборудования для организации с school_id 110
2025-04-21 15:16:53,895 - contracts - INFO - Список оборудования в контексте: 1 позиций
2025-04-21 15:16:53,911 - contracts - INFO - Получена информация об ответственном лице по school_id 110: {'job_title': 'Директор', 'surname': 'Медведева', 'name': 'Евгения', 'second_name': 'Владимировна'}
2025-04-21 15:16:53,911 - contracts - INFO - Добавлены переменные в родительном падеже: Директора, Медведева Евгения Владимировны
2025-04-21 15:16:53,911 - contracts - INFO - Ключи контекста: ['code_contract', 'day', 'month_name', 'year', 'year_next', 'num_contract', 'date_contract', 'name_contract', 'school_id', 'school_fullname', 'school_address', 'INN', 'KPP', 'OKPO', 'OGRN', 'cur_acc', 'bank_acc', 'pers_acc', 'fullname', 'address', 'equipment_list', 'total', 'total_price_text', 'job_title', 'surname', 'name', 'second_name', 'name_initial', 'second_name_initial', 'full_name_with_initials', 'responsible_fullname', 'job_title_genitive', 'surname_genitive', 'name_genitive', 'second_name_genitive', 'full_name_genitive', 'full_name_with_initials_genitive', 'job_title_and_full_name_genitive', 'job_title_and_full_name_with_initials_genitive']
2025-04-21 15:16:53,911 - contracts - INFO - Переменные для ответственного лица:
2025-04-21 15:16:53,911 - contracts - INFO -   job_title: Директор
2025-04-21 15:16:53,911 - contracts - INFO -   surname: Медведева
2025-04-21 15:16:53,911 - contracts - INFO -   name: Евгения
2025-04-21 15:16:53,911 - contracts - INFO -   second_name: Владимировна
2025-04-21 15:16:53,911 - contracts - INFO -   job_title_genitive: Директора
2025-04-21 15:16:53,926 - contracts - INFO -   surname_genitive: Медведева
2025-04-21 15:16:53,926 - contracts - INFO -   name_genitive: Евгения
2025-04-21 15:16:53,926 - contracts - INFO -   second_name_genitive: Владимировны
2025-04-21 15:16:53,926 - contracts - INFO -   full_name_with_initials: Медведева Е. В.
2025-04-21 15:16:53,926 - contracts - INFO -   full_name_with_initials_genitive: Медведева Е. В.
2025-04-21 15:16:53,926 - contracts - INFO -   job_title_and_full_name_genitive: Директора Медведева Евгения Владимировны
2025-04-21 15:16:53,926 - contracts - INFO -   job_title_and_full_name_with_initials_genitive: Директора Медведева Е. В.
2025-04-21 15:16:54,634 - contracts - INFO - Договор сформирован и сохранён: C:\Users\erokhina\Documents\TempContracts\preview_contract_23_20250421151653.docx
2025-04-21 15:17:59,549 - contracts - INFO - Загружены реквизиты для school_id 109: {'code_contract': '1', 'day': 21, 'month_name': 'апреля', 'year': 2025, 'year_next': 2026, 'num_contract': '0366200035624007702', 'date_contract': '02.12.2024', 'name_contract': 'на поставку ноутбуков для проведения ГИА в Тульской области', 'school_id': 109, 'school_fullname': 'Муниципальное казенное общеобразовательное учреждение "Киреевский центр образования № 1" муниципального образования Киреевский район', 'school_address': '301260, Тульская обл., Киреевский район, г. Киреевск, ул. Ленина, д. 32', 'INN': 7128004996, 'KPP': 712801001, 'OKPO': 43540770, 'OGRN': 1027101679681, 'cur_acc': '40102810445370000059', 'bank_acc': '03231643706280006600', 'pers_acc': '852020171', 'fullname': 'Муниципальное казенное общеобразовательное учреждение "Киреевский центр образования № 1" муниципального образования Киреевский район', 'address': '301260, Тульская обл., Киреевский район, г. Киреевск, ул. Ленина, д. 32'}
2025-04-21 15:17:59,596 - contracts - INFO - Получено 1 позиций оборудования для организации с school_id 109
2025-04-21 15:17:59,596 - contracts - INFO - Список оборудования в контексте: 1 позиций
2025-04-21 15:17:59,627 - contracts - INFO - Получена информация об ответственном лице по school_id 109: {'job_title': 'Директор', 'surname': 'Кольцова', 'name': 'Нина', 'second_name': 'Николаевна'}
2025-04-21 15:17:59,627 - contracts - INFO - Добавлены переменные в родительном падеже: Директора, Кольцова Нина Николаевны
2025-04-21 15:17:59,627 - contracts - INFO - Ключи контекста: ['code_contract', 'day', 'month_name', 'year', 'year_next', 'num_contract', 'date_contract', 'name_contract', 'school_id', 'school_fullname', 'school_address', 'INN', 'KPP', 'OKPO', 'OGRN', 'cur_acc', 'bank_acc', 'pers_acc', 'fullname', 'address', 'equipment_list', 'total', 'total_price_text', 'job_title', 'surname', 'name', 'second_name', 'name_initial', 'second_name_initial', 'full_name_with_initials', 'responsible_fullname', 'job_title_genitive', 'surname_genitive', 'name_genitive', 'second_name_genitive', 'full_name_genitive', 'full_name_with_initials_genitive', 'job_title_and_full_name_genitive', 'job_title_and_full_name_with_initials_genitive']
2025-04-21 15:17:59,627 - contracts - INFO - Переменные для ответственного лица:
2025-04-21 15:17:59,627 - contracts - INFO -   job_title: Директор
2025-04-21 15:17:59,627 - contracts - INFO -   surname: Кольцова
2025-04-21 15:17:59,627 - contracts - INFO -   name: Нина
2025-04-21 15:17:59,627 - contracts - INFO -   second_name: Николаевна
2025-04-21 15:17:59,627 - contracts - INFO -   job_title_genitive: Директора
2025-04-21 15:17:59,627 - contracts - INFO -   surname_genitive: Кольцова
2025-04-21 15:17:59,627 - contracts - INFO -   name_genitive: Нина
2025-04-21 15:17:59,627 - contracts - INFO -   second_name_genitive: Николаевны
2025-04-21 15:17:59,627 - contracts - INFO -   full_name_with_initials: Кольцова Н. Н.
2025-04-21 15:17:59,627 - contracts - INFO -   full_name_with_initials_genitive: Кольцова Н. Н.
2025-04-21 15:17:59,627 - contracts - INFO -   job_title_and_full_name_genitive: Директора Кольцова Нина Николаевны
2025-04-21 15:17:59,627 - contracts - INFO -   job_title_and_full_name_with_initials_genitive: Директора Кольцова Н. Н.
2025-04-21 15:18:00,330 - contracts - INFO - Договор сформирован и сохранён: C:\Users\erokhina\Documents\TempContracts\preview_contract_11_20250421151759.docx
